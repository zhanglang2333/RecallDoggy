<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§  AI RAG çŸ¥è¯†åº“</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: linear-gradient(135deg, #A0D8EF 0%, #7CC2DE 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .stats { background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 20px; display: inline-block; }
        .card { background: white; border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .card h2 { color: #A0D8EF; margin-bottom: 20px; font-size: 1.5em; }
        textarea, input[type="text"] { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; font-family: inherit; margin-bottom: 15px; transition: border 0.3s; }
        textarea:focus, input:focus { outline: none; border-color: #A0D8EF; }
        textarea { min-height: 120px; resize: vertical; }
        button { background: linear-gradient(135deg, #A0D8EF 0%, #7CC2DE 100%); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
        button:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102,126,234,0.4); }
        button:active { transform: translateY(0); }
        .result-item { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #A0D8EF; position: relative; }
        .result-item:hover { background: #e9ecef; }
        .similarity { position: absolute; top: 15px; right: 15px; background: #A0D8EF; color: white; padding: 5px 12px; border-radius: 15px; font-size: 12px; font-weight: 600; }
        .category { display: inline-block; background: #7CC2DE; color: white; padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-right: 5px; }
        .tag { display: inline-block; background: #e0e0e0; padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-right: 5px; margin-top: 5px; }
        .time { color: #999; font-size: 12px; margin-top: 10px; }
        .delete-btn { background: #dc3545; padding: 5px 12px; font-size: 12px; margin-top: 10px; }
        .loading { text-align: center; padding: 20px; color: #999; }
        .message { padding: 12px; border-radius: 8px; margin-bottom: 15px; font-weight: 500; }
        .message.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .message.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } .header h1 { font-size: 1.8em; } }
    
    .today-banner {
      text-align: center;
      padding: 10px 20px;
      margin: -10px auto 20px auto;
      max-width: 700px;
      font-size: 14px;
      color: #555;
      background: linear-gradient(135deg, #f0f9ff, #e8f4fd);
      border-radius: 12px;
      border: 1px solid #A0D8EF;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .today-banner .item { white-space: nowrap; }
    .today-banner .divider { color: #A0D8EF; }
    .today-banner .festival { color: #e74c3c; font-weight: 500; }

  </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§  AI RAG çŸ¥è¯†åº“</h1>
            <div class="stats">ğŸ“š æ€»çŸ¥è¯†æ•°ï¼š<strong id="totalCount">{{ total }}</strong></div>
        </div>
        <div class="grid">
            
    <div class="today-banner" id="todayBanner">
      <span class="item" id="todaySolar">ğŸ“… åŠ è½½ä¸­...</span>
    </div>

    <div class="card">
                <h2>âœï¸ å†™å…¥çŸ¥è¯†</h2>
                <div id="writeMessage"></div>
                <textarea id="writeContent" placeholder="è¾“å…¥çŸ¥è¯†å†…å®¹..."></textarea>
                <input type="text" id="writeCategory" placeholder="åˆ†ç±»ï¼ˆå¦‚ï¼šæŠ€æœ¯ã€ç”Ÿæ´»ï¼‰" value="é€šç”¨">
                <input type="text" id="writeTags" placeholder="æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼Œå¦‚ï¼šPython,AIï¼‰">
                <button onclick="writeKnowledge()">ğŸ’¾ ä¿å­˜åˆ°çŸ¥è¯†åº“</button>
            </div>
            <div class="card">
                <h2>ğŸ” æœç´¢çŸ¥è¯†</h2>
                <input type="text" id="searchQuery" placeholder="è¾“å…¥æœç´¢å…³é”®è¯..." onkeypress="if(event.key==='Enter') searchKnowledge()">
                            <div style="margin-bottom: 15px;">
                <label style="font-size: 14px; color: #666;">
                    è¿”å›æ¡æ•°ï¼š<strong id="topKValue">5</strong>
                </label>
                <input type="range" id="topKSlider" min="1" max="20" value="5"
                    style="width: 100%; margin-top: 5px; accent-color: #A0D8EF;"
                    oninput="document.getElementById('topKValue').textContent = this.value">
            </div>
            <button onclick="searchKnowledge()">ğŸ” æœç´¢</button>
            </div>
        </div>
        <div class="card">
            <h2>ğŸ“– æœç´¢ç»“æœ</h2>
            <div id="searchResults"><div class="loading">è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢...</div></div>
        </div>
    </div>
    
    <div class="card">
        <h2>ğŸ“‹ çŸ¥è¯†åˆ—è¡¨</h2>
        <button onclick="loadList()">ğŸ“‹ åŠ è½½å…¨éƒ¨</button>
        <div id="listResults" style="margin-top:15px;"></div>
    </div>

    
    <div class="card">
      <h2>ğŸ’ çºªå¿µæ—¥ç®¡ç†</h2>
      <div style="margin-bottom:12px;">
        <input type="text" id="annivName" placeholder="çºªå¿µæ—¥åç§°ï¼Œå¦‚ï¼šå¦ˆå¦ˆç”Ÿæ—¥" style="width:100%;padding:8px;border:1px solid #ddd;border-radius:8px;margin-bottom:8px;">
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
          <select id="annivType" style="padding:8px;border:1px solid #ddd;border-radius:8px;">
            <option value="solar">å…¬å†</option>
            <option value="lunar">å†œå†</option>
          </select>
          <input type="text" id="annivDate" placeholder="æ—¥æœŸï¼Œå¦‚ 02-14 æˆ– æ­£æœˆåˆä¸€" style="flex:1;padding:8px;border:1px solid #ddd;border-radius:8px;">
        </div>
        <button onclick="addAnniversary()" style="width:100%;padding:10px;background:#A0D8EF;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:15px;">æ·»åŠ çºªå¿µæ—¥</button>
      </div>
      <div id="annivList" style="margin-top:12px;"></div>
      <button onclick="loadAnniversaries()" style="width:100%;padding:8px;background:#f0f9ff;color:#555;border:1px solid #A0D8EF;border-radius:8px;cursor:pointer;margin-top:8px;">åˆ·æ–°çºªå¿µæ—¥åˆ—è¡¨</button>
    </div>

    <script>
        const API_BASE = '';
        async function writeKnowledge() {
            const content = document.getElementById('writeContent').value.trim();
            const category = document.getElementById('writeCategory').value.trim() || 'é€šç”¨';
            const tagsInput = document.getElementById('writeTags').value.trim();
            const tags = tagsInput ? tagsInput.split(',').map(t => t.trim()) : [];
            if (!content) { showMessage('writeMessage', 'è¯·è¾“å…¥çŸ¥è¯†å†…å®¹', 'error'); return; }
            try {
                const response = await fetch(API_BASE + '/api/write', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({content, category, tags}) });
                const result = await response.json();
                if (result.status === 'success') { showMessage('writeMessage', 'âœ… ' + result.message, 'success'); document.getElementById('writeContent').value = ''; document.getElementById('writeTags').value = ''; updateStats(); }
                else { showMessage('writeMessage', 'âš ï¸ ' + result.message, 'error'); }
            } catch (error) { showMessage('writeMessage', 'âŒ æ“ä½œå¤±è´¥: ' + error.message, 'error'); }
        }
        async function searchKnowledge() {
            const query = document.getElementById('searchQuery').value.trim();
            if (!query) return;
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<div class="loading">ğŸ” æœç´¢ä¸­...</div>';
            try {
                const response = await fetch(API_BASE + '/api/search', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({query, top_k: parseInt(document.getElementById('topKSlider').value)}) });
                const data = await response.json();
                if (data.results.length === 0) { resultsDiv.innerHTML = '<div class="loading">ğŸ˜” æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çŸ¥è¯†</div>'; return; }
                resultsDiv.innerHTML = data.results.map(item => '<div class="result-item"><div class="similarity">' + item.similarity + '% åŒ¹é…</div><div><span class="category">' + item.category + '</span>' + item.tags.filter(t => t).map(tag => '<span class="tag">' + tag + '</span>').join('') + '</div><div style="margin-top:10px;line-height:1.6;">' + item.content + '</div><div class="time">ğŸ“… ' + item.time + '</div><button class="delete-btn" onclick="deleteKnowledge(\'' + item.id + '\')">ğŸ—‘ï¸ åˆ é™¤</button></div>').join('');
            } catch (error) { resultsDiv.innerHTML = '<div class="loading">âŒ æœç´¢å¤±è´¥: ' + error.message + '</div>'; }
        }
        async function deleteKnowledge(id) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡çŸ¥è¯†å—ï¼Ÿ')) return;
            try { await fetch(API_BASE + '/api/delete/' + id, {method: 'DELETE'}); searchKnowledge(); updateStats(); }
            catch (error) { alert('åˆ é™¤å¤±è´¥: ' + error.message); }
        }
        async function updateStats() {
            try { const response = await fetch(API_BASE + '/api/stats'); const data = await response.json(); document.getElementById('totalCount').textContent = data.total; }
            catch (error) { console.error('è·å–ç»Ÿè®¡å¤±è´¥', error); }
        }
        function showMessage(elementId, message, type) {
            const div = document.getElementById(elementId);
            div.innerHTML = '<div class="message ' + type + '">' + message + '</div>';
            setTimeout(() => { div.innerHTML = ''; }, 3000);
        }
        setInterval(updateStats, 30000);
    
        async function loadList() {
            try {
                const res = await fetch('/api/list?limit=50');

                const data = await res.json();
                window._listItems = data.results || [];
                const div = document.getElementById('listResults');
                if (!data.results.length) {
                    div.innerHTML = '<p style="color:#666">æš‚æ— çŸ¥è¯†</p>';
                    return;
                }
                let h = '<p style="color:#666;margin-bottom:10px">å…± ' + data.total + ' æ¡ï¼Œæ˜¾ç¤ºå‰ ' + data.results.length + ' æ¡</p>';
                data.results.forEach(function(item) {
                    var p = item.content.length > 100 ? item.content.substring(0,100) + '...' : item.content;
                    h += '<div style="background:#f8f9fa;padding:12px;border-radius:8px;margin-bottom:8px;border-left:3px solid #A0D8EF">';
                    h += '<p style="margin:0 0 5px;font-size:14px">' + p + '</p>';
                    h += '<div style="display:flex;justify-content:space-between;align-items:center">';
                    h += '<small style="color:#999">' + item.category + ' | ' + item.time + '</small>';
                    h += '<button onclick="openEditModal(\'' + item.id + '\')" style="background:#A0D8EF;color:#fff;border:none;padding:4px 10px;border-radius:4px;cursor:pointer;font-size:12px;margin-right:6px;">âœï¸</button>';
                h += '<button data-id="' + item.id + '" onclick="deleteAndRefresh(this.dataset.id)" style="background:#ff6b6b;color:#fff;border:none;padding:4px 10px;border-radius:4px;cursor:pointer;font-size:12px">ğŸ—‘ï¸</button>';
                    h += '</div></div>';
                });
                div.innerHTML = h;
            } catch(e) {
                document.getElementById('listResults').innerHTML = '<p style="color:red">åŠ è½½å¤±è´¥</p>';
            }
        }
        async function deleteAndRefresh(id) {
            if (!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ')) return;
            await fetch('/api/delete/' + id, {method: 'DELETE'});
            loadList();
        }

    
    // åŠ è½½ä»Šæ—¥ä¿¡æ¯
    async function loadToday() {
      try {
        const res = await fetch('/api/today');
        const data = await res.json();
        let parts = [
          'ğŸ“… ' + data.solar + ' ' + data.weekday,
          'ğŸ® ' + data.lunar
        ];
        if (data.solar_term) parts.push('ğŸŒ¿ ' + data.solar_term);
        if (data.festivals && data.festivals.length > 0) {
          parts.push('<span class="festival">ğŸ‰ ' + data.festivals.join(' / ') + '</span>');
        }
        document.getElementById('todayBanner').innerHTML = 
          parts.map(p => '<span class="item">' + p + '</span>').join('<span class="divider">|</span>');
      } catch(e) {
        document.getElementById('todayBanner').innerHTML = '<span class="item">ğŸ“… æ—¥æœŸåŠ è½½å¤±è´¥</span>';
      }
    }
    loadToday();

  
    // çºªå¿µæ—¥ç®¡ç†
    async function addAnniversary() {
      const name = document.getElementById('annivName').value.trim();
      const type = document.getElementById('annivType').value;
      const date = document.getElementById('annivDate').value.trim();
      
      if (!name || !date) {
        alert('è¯·å¡«å†™çºªå¿µæ—¥åç§°å’Œæ—¥æœŸ');
        return;
      }
      
      try {
        const res = await fetch('/api/write', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            content: name,
            category: 'çºªå¿µæ—¥',
            tags: [date, type]
          })
        });
        const data = await res.json();
        if (data.id) {
          alert('âœ… çºªå¿µæ—¥å·²æ·»åŠ ï¼');
          document.getElementById('annivName').value = '';
          document.getElementById('annivDate').value = '';
          loadAnniversaries();
          loadToday();
        } else {
          alert('âŒ æ·»åŠ å¤±è´¥');
        }
      } catch(e) {
        alert('âŒ ç½‘ç»œé”™è¯¯');
      }
    }
    
    async function loadAnniversaries() {
      try {
        const res = await fetch('/api/list');
        const data = await res.json();
        const items = data.results || data.items || data;
        const annivs = items.filter(item => item.category === 'çºªå¿µæ—¥');
        const container = document.getElementById('annivList');
        if (annivs.length === 0) {
          container.innerHTML = '<p style="color:#999;text-align:center;">æš‚æ— çºªå¿µæ—¥</p>';
          return;
        }
        let h = '';
        for (const item of annivs) {
          const tags = (item.tags || []).join(' ');
          const id = item.id || item.pk;
          h += `<div style="display:flex;justify-content:space-between;align-items:center;padding:8px;margin:4px 0;background:#f9f9f9;border-radius:8px;">
            <span>ğŸ’ \({item.content} <small style="color:#999;">(\){tags})</small></span>
            <button onclick="deleteAnniversary('${id}',this)" style="background:#ff6b6b;color:#fff;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;">åˆ é™¤</button>
          </div>`;
        }
        container.innerHTML = h;
      } catch(e) {
        console.error('loadAnniversaries error:', e);
        document.getElementById('annivList').innerHTML = '<p style="color:#e74c3c;">åŠ è½½å¤±è´¥</p>';
      }
    }
    
    async function deleteAnniversary(id, btn) {
      if (!confirm('ç¡®å®šåˆ é™¤è¿™ä¸ªçºªå¿µæ—¥ï¼Ÿ')) return;
      try {
        const res = await fetch('/api/delete/' + id, {method:'DELETE'});
        const data = await res.json();
        if (data.message) {
          btn.parentElement.remove();
          loadToday();
        }
      } catch(e) {
        alert('åˆ é™¤å¤±è´¥');
      }
    }
    
    loadAnniversaries();

  </script>

<!-- ç¼–è¾‘å¼¹çª— -->
<div id="editModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000;">
  <div style="background:white; border-radius:16px; padding:24px; width:90%; max-width:500px; max-height:80vh; overflow-y:auto; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);">
    <h3 style="margin:0 0 16px 0; color:#333;">âœï¸ ç¼–è¾‘çŸ¥è¯†</h3>
    <input type="hidden" id="editId">
    <div style="margin-bottom:12px;">
      <label style="display:block; font-size:14px; color:#666; margin-bottom:4px;">å†…å®¹</label>
      <textarea id="editContent" rows="6" style="width:100%; padding:10px; border:2px solid #e0e0e0; border-radius:10px; font-size:14px; resize:vertical; box-sizing:border-box;"></textarea>
    </div>
    <div style="margin-bottom:12px;">
      <label style="display:block; font-size:14px; color:#666; margin-bottom:4px;">åˆ†ç±»</label>
      <input type="text" id="editCategory" style="width:100%; padding:10px; border:2px solid #e0e0e0; border-radius:10px; font-size:14px; box-sizing:border-box;">
    </div>
    <div style="margin-bottom:16px;">
      <label style="display:block; font-size:14px; color:#666; margin-bottom:4px;">æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
      <input type="text" id="editTags" style="width:100%; padding:10px; border:2px solid #e0e0e0; border-radius:10px; font-size:14px; box-sizing:border-box;">
    </div>
    <div style="display:flex; gap:10px;">
      <button onclick="closeEditModal()" style="flex:1; padding:12px; border:2px solid #e0e0e0; background:white; border-radius:10px; font-size:15px; cursor:pointer;">å–æ¶ˆ</button>
      <button onclick="saveEdit()" style="flex:1; padding:12px; border:none; background:#A0D8EF; color:white; border-radius:10px; font-size:15px; font-weight:bold; cursor:pointer;">ğŸ’¾ ä¿å­˜</button>
    </div>
  </div>
</div>
<script>
function openEditModal(id) {
    const items = window._listItems || [];
    const item = items.find(i => i.id === id);
    if (!item) { alert('æ‰¾ä¸åˆ°è¯¥æ¡ç›®'); return; }
    document.getElementById('editId').value = id;
    document.getElementById('editContent').value = item.content || '';
    document.getElementById('editCategory').value = item.category || 'é€šç”¨';
    document.getElementById('editTags').value = (item.tags || []).filter(t => t).join(',');
    document.getElementById('editModal').style.display = 'block';
}
function closeEditModal() {
    document.getElementById('editModal').style.display = 'none';
}
async function saveEdit() {
    const id = document.getElementById('editId').value;
    const content = document.getElementById('editContent').value.trim();
    const category = document.getElementById('editCategory').value.trim() || 'é€šç”¨';
    const tags = document.getElementById('editTags').value.split(',').map(t => t.trim()).filter(t => t);
    if (!content) { alert('å†…å®¹ä¸èƒ½ä¸ºç©º'); return; }
    try {
        const res = await fetch('/api/update/' + id, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({content, category, tags})
        });
        if (res.ok) {
            closeEditModal();
            loadList();
        } else {
            const data = await res.json();
            alert('æ›´æ–°å¤±è´¥: ' + (data.detail || 'æœªçŸ¥é”™è¯¯'));
        }
    } catch(e) { alert('è¯·æ±‚å¤±è´¥: ' + e.message); }
}
document.getElementById('editModal').addEventListener('click', function(e) {
    if (e.target === this) closeEditModal();
});

    // åŠ è½½ä»Šæ—¥ä¿¡æ¯
    async function loadToday() {
      try {
        const res = await fetch('/api/today');
        const data = await res.json();
        let parts = [
          'ğŸ“… ' + data.solar + ' ' + data.weekday,
          'ğŸ® ' + data.lunar
        ];
        if (data.solar_term) parts.push('ğŸŒ¿ ' + data.solar_term);
        if (data.festivals && data.festivals.length > 0) {
          parts.push('<span class="festival">ğŸ‰ ' + data.festivals.join(' / ') + '</span>');
        }
        document.getElementById('todayBanner').innerHTML = 
          parts.map(p => '<span class="item">' + p + '</span>').join('<span class="divider">|</span>');
      } catch(e) {
        document.getElementById('todayBanner').innerHTML = '<span class="item">ğŸ“… æ—¥æœŸåŠ è½½å¤±è´¥</span>';
      }
    }
    loadToday();

  
    // çºªå¿µæ—¥ç®¡ç†
    async function addAnniversary() {
      const name = document.getElementById('annivName').value.trim();
      const type = document.getElementById('annivType').value;
      const date = document.getElementById('annivDate').value.trim();
      
      if (!name || !date) {
        alert('è¯·å¡«å†™çºªå¿µæ—¥åç§°å’Œæ—¥æœŸ');
        return;
      }
      
      try {
        const res = await fetch('/api/write', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            content: name,
            category: 'çºªå¿µæ—¥',
            tags: [date, type]
          })
        });
        const data = await res.json();
        if (data.id) {
          alert('âœ… çºªå¿µæ—¥å·²æ·»åŠ ï¼');
          document.getElementById('annivName').value = '';
          document.getElementById('annivDate').value = '';
          loadAnniversaries();
          loadToday();
        } else {
          alert('âŒ æ·»åŠ å¤±è´¥');
        }
      } catch(e) {
        alert('âŒ ç½‘ç»œé”™è¯¯');
      }
    }
    
    async function loadAnniversaries() {
      try {
        const res = await fetch('/api/list');
        const data = await res.json();
        const annivs = (data.results || data.items || data).filter(item => item.category === 'çºªå¿µæ—¥');
        const container = document.getElementById('annivList');
        if (annivs.length === 0) {
          container.innerHTML = '<p style="color:#999;text-align:center;">æš‚æ— çºªå¿µæ—¥</p>';
          return;
        }
        container.innerHTML = annivs.map(item => {
          const tags = (item.tags || []).join(' ');
          return '<div style="display:flex;justify-content:space-between;align-items:center;padding:8px;margin:4px 0;background:#f9f9f9;border-radius:8px;">' +
            '<span>ğŸ’ ' + item.content + ' <small style="color:#999;">(' + tags + ')</small></span>' +
            '<button onclick="deleteAnniversary(\''+item.id+'\',this)" style="background:#ff6b6b;color:#fff;border:none;border-radius:6px;padding:4px 10px;cursor:pointer;">åˆ é™¤</button>' +
          '</div>';
        }).join('');
      } catch(e) {
        document.getElementById('annivList').innerHTML = '<p style="color:#e74c3c;">åŠ è½½å¤±è´¥</p>';
      }
    }
    
    async function deleteAnniversary(id, btn) {
      if (!confirm('ç¡®å®šåˆ é™¤è¿™ä¸ªçºªå¿µæ—¥ï¼Ÿ')) return;
      try {
        const res = await fetch('/api/delete/' + id, {method:'DELETE'});
        const data = await res.json();
        if (data.message) {
          btn.parentElement.remove();
          loadToday();
        }
      } catch(e) {
        alert('åˆ é™¤å¤±è´¥');
      }
    }
    
    // é¡µé¢åŠ è½½æ—¶ä¹ŸåŠ è½½çºªå¿µæ—¥åˆ—è¡¨
    loadAnniversaries();

  </script>

</body>
</html>
